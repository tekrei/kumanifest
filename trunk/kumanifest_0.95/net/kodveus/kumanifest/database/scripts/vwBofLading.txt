CREATE VIEW `kumanifest`.`vwboflading` AS
SELECT bl.blNo, bl.shipper, bl.consignee, bl.notify, bl.notify2, voyage.voyage, vessel.vesselCode, vessel.vesselName, location.location AS placeOfReceipt, location_1.location AS portOfDischarge, location_2.location AS portOfLoading, location_3.location AS finalDischargePlace FROM bl INNER JOIN voyage ON bl.voyageId = voyage.voyageId INNER JOIN vessel ON voyage.vesselId = vessel.vesselId LEFT OUTER JOIN location location_2 ON bl.portOfLoading = location_2.locationId LEFT OUTER JOIN location location_3 ON bl.finalDischargePlace = location_3.locationId LEFT OUTER JOIN location location_1 ON bl.portOfDischarge = location_1.locationId LEFT OUTER JOIN location ON bl.portOfLoading = location.locationId;